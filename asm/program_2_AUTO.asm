|INTEG LD HL,INSTR
 CALL PRTMES
LETSGO:
 CALL SCAN
 CP 0DH
 JR NZ,LETSGO
 LD HL,SPEEDT
 CALL PRTMES
NOCHMA:
 CALL SCAN
 CP 04CH
 JR Z,LNG2
 CP 04DH
 JR Z,MID2
 CP 053H
 JR Z,SCHN2
 JR NOCHMA
LNG2:
 LD A,729
 JR WEITER
MID2:
 LD A,364
 JR WEITER
SCHN2:
 LD A,182
WEITER:
 LD (SPEMEM),A
 LD HL,NTOT
 CALL PRTMES
LOPER:
 CALL SCAN
 CP 04EH
 JR Z,NEWTEX
 CP 04FH
 JP Z,OLDTEX
 JR LOPER
NEWTEX:
 LD HL,INPTTE
 CALL PRTMES
 LD HL,TEXBEG
 LD (BUFFHL),HL
ERRETU:
 CALL SCAN
 LD HL,(BUFFHL)
NOERRO:
 LD (HL),A
 CALL CONVER
 PUSH HL
 CALL CHK40
 CALL SCAN
 POP HL
 CP 05FH
 JR Z,ERRMEL
 CP 0DH
 JR Z,INTEM
 INC HL
 JR NOERRO
INTEM:
 INC HL
 LD (HL),0DH
 JR INTEG
ERRMEL:
 LD (BUFFHL),HL
 LD HL,(DISP)
 LD DE,02
 SBC HL,DE
 LD (HL),0FH
 INC HL
 LD (HL),0FH
 JP ERRETU
TEXBEG:
 DEFS 80
SPEMEM:
 DEFS 1
BUFFHL:
 DEFS 2
OLDTEX:
 LD HL,TEXBEG
 LD (BUFFHL),HL
NEWLE2:
 XOR A
 LD A,(HL)
 SBC A,40H
 LD E,0
 LD HL,TABMEM
 LD A,D
 ADD HL,DE
 LD A,(HL)
 CP 20H
 JP Z,PAUS
 CP 0DH
 JP Z,INTEG
 LD (ABUFF),A
 AND 07
 LD B,A
OUTROU:
 LD A,(ABUFF)
 SLA A
 JP C,STRIND
 JP POTIND
STRIND:
 DEC B
 JP Z,ENDLET
 LD HL,(SPEMEM)
 PUSH BC
 CALL TONE1K
 CALL TONE1K
 CALL TONE1K
 CALL DELAY
 POP BC
 JP OUTROU
POTIND:
 DEC B
 JP Z,ENDLET
 LD HL,(SPEMEM)
 PUSH BC
 CALL TONE1K
 CALL DELAY
 POP BC
 JP OUTROU
ENDLET:
 LD HL,(BUFFHL)
 INC HL
 LD (BUFFHL),HL
 LD D,3
ENDLOP:
 CALL DELAY
 DEC D
 JR NZ,ENDLOP
 JR NEWLE2
DELAY:
 LD B,0FH
DELOP2:
 LD HL,(SPEMEM)
DELOOP:
 NOP
 NOP
 DEC HL
 JR Z,DELOOP
 DJNZ DELOP2
 RET
PAUS:
 LD B,4
PAUSLO:
 CALL DELAY
 DJNZ PAUSLO
 JR ENDLET
BBUFF:
 DEFS 1
ABUFF:
 DEFS 1
INSTR:
 DEFM'MORSEAUTOMAT V.1'
 DEFB 0DH
SPEEDT:
 DEFM'120(S) 60(M) 30(L)?'
 DEFB 0DH
NTOT:
 DEFM'OLDTEXT(O)NEWTEXT(N)'
 DEFB 0DH
INPTTE:
 DEFM'  INPUT'
 DEFB 0DH
TABMEM:
 DEFW 4200H
 DEFW 0A484H
 DEFW 0183H
 DEFW 0C324H
 DEFW 0204H
 DEFW 0A374H
 DEFW 0C244H
 DEFW 0E382H
 DEFW 0D464H
 DEFW 0343H
 DEFW 2381H
 DEFW 6314H
 DEFW 0B494H
 DEFB 0C4H
PRTMES:
 EQU 0886H
SCAN:
 EQU 0246H
CONVER:
 EQU 0821H
CHK40:
 EQU 0912H
DISP:
 EQU 0FF84H
TONE1K:
 EQU 086FH
END