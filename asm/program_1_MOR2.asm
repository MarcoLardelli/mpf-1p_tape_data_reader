| LD HL,BEGIN
 CALL PRTMES
ANFANG:
 CALL SCAN
 CP 0DH
 JR NZ,ANFANG
 LD HL,TEMPO?
 CALL PRTMES
 CALL SCAN
 LD HL,BUFFER
 CP 4CH
 JR Z,LANG
 CP 4DH
 JR Z,MIDI
 CP 53H
 JR Z,SCHN
 JR ANFANG
LANG:
 LD (HL),40H
 JR MORSE
MIDI:
 LD (HL),15H
 JR MORSE
SCHN:
 LD (HL),0AH
MORSE:
 CALL CLEAR
 LD IX,DISPBF
 JR LOOP
NEWORD:
 CALL CONVER
 CALL CHK40
LOOP:
 LD A,2H
 LD E,A
RETE:
 LD A,(BUFFER)
 LD B,A
 ADD A,B
 ADD A,B
 LD B,A
LOOP3:
 CALL SCAN1
 CP 11H
 JR Z,INDI
 DJNZ LOOP3
 JR OUT
INDI:
 LD A,(BUFFER)
 LD B,A
LOOP2:
 CALL SCAN1
 SBC A,11H
 JR NZ,POINT
 DJNZ LOOP2
KORREK:
 CALL SCAN1
 SBC A,011H
 JP NZ,DIGI
 INC B
 JP KORREK
DIGI:
 LD A,(BUFFER)
 ADD A,B
 LD B,0
DIV:
 INC B
 SBC A,02
 JP P,DIV
 LD A,B
 ADD A,01
 LD (BUFFER),A
 LD A,E
 ADD A,1
 SLA A
 LD E,A
 JR RETE
POINT:
 LD A,E
 SLA A
 LD E,A
 JR RETE
OUT:
 LD D,0
 LD A,E
 AND 0C1H
 JP Z,NOEROR
 LD A,03FH
 JP NEWORD
NOEROR:
 LD HL,ZACK
 ADD HL,DE
 LD A,(HL)
 JP NEWORD
ZACK:
 DEFM'?? ?E?T?I?A?N?M?S?U?'
 DEFM 'R?W?D?K?G?O?H?V?F???'
 DEFM 'L???P?J?B?X?C?Y?Z?Q'
BEGIN:
 DEFM 'MORSE'
 DEFM 'DECODER  V.1'
 DEFB 0DH
TEMPO?:
 DEFM 'TEMPO?'
 DEFB 0DH
PRTMES:
 EQU 0886H
SCAN:
 EQU 0246H
BUFFER:
 DEFS 1
CLEAR:
 EQU 09B9H
CONVER:
 EQU 0821H
CHK40:
 EQU 0912H
DISPBF:
 EQU 0FF2CH
SCAN1:
 EQU 029BH
END